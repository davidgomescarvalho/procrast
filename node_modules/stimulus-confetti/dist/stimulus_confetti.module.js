import t from"canvas-confetti";function e(){return e=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},e.apply(this,arguments)}function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}function n(t){return t.replace(/(?:[_-])([a-z0-9])/g,(t,e)=>e.toUpperCase())}function o(t){return t.charAt(0).toUpperCase()+t.slice(1)}function i(t,e){const r=a(t);return Array.from(r.reduce((t,r)=>(function(t,e){const r=t[e];return Array.isArray(r)?r:[]}(r,e).forEach(e=>t.add(e)),t),new Set))}function a(t){const e=[];for(;t;)e.push(t),t=Object.getPrototypeOf(t);return e.reverse()}function s([t,e],r){return function(t){const e=`${o=t.token,o.replace(/([A-Z])/g,(t,e)=>`-${e.toLowerCase()}`)}-value`,r=function(t){const e=function(t){const e=c(t.typeObject.type);if(!e)return;const r=u(t.typeObject.default);if(e!==r)throw new Error(`The specified default value for the Stimulus Value "${t.controller?`${t.controller}.${t.token}`:t.token}" must match the defined type "${e}". The provided default value of "${t.typeObject.default}" is of type "${r}".`);return e}({controller:t.controller,token:t.token,typeObject:t.typeDefinition}),r=u(t.typeDefinition),n=c(t.typeDefinition),o=e||r||n;if(o)return o;throw new Error(`Unknown value type "${t.controller?`${t.controller}.${t.typeDefinition}`:t.token}" for "${t.token}" value`)}(t);var o;return{type:r,key:e,name:n(e),get defaultValue(){return function(t){const e=c(t);if(e)return l[e];const r=t.default;return void 0!==r?r:t}(t.typeDefinition)},get hasCustomDefaultValue(){return void 0!==u(t.typeDefinition)},reader:f[r],writer:p[r]||p.default}}({controller:r,token:t,typeDefinition:e})}function c(t){switch(t){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function u(t){switch(typeof t){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}return Array.isArray(t)?"array":"[object Object]"===Object.prototype.toString.call(t)?"object":void 0}(()=>{try{!function(){const t=function(t){function e(){return Reflect.construct(t,arguments,new.target)}return e.prototype=Object.create(t.prototype,{constructor:{value:e}}),Reflect.setPrototypeOf(e,t),e}(function(){this.a.call(this)});t.prototype.a=function(){},new t}()}catch(t){return t=>class extends t{}}})();const l={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},f={array(t){const e=JSON.parse(t);if(!Array.isArray(e))throw new TypeError(`expected value of type "array" but instead got value "${t}" of type "${u(e)}"`);return e},boolean:t=>!("0"==t||"false"==String(t).toLowerCase()),number:t=>Number(t),object(t){const e=JSON.parse(t);if(null===e||"object"!=typeof e||Array.isArray(e))throw new TypeError(`expected value of type "object" but instead got value "${t}" of type "${u(e)}"`);return e},string:t=>t},p={default:function(t){return`${t}`},array:d,object:d};function d(t){return JSON.stringify(t)}class h{constructor(t){this.context=t}static get shouldLoad(){return!0}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(t,{target:e=this.element,detail:r={},prefix:n=this.identifier,bubbles:o=!0,cancelable:i=!0}={}){const a=new CustomEvent(n?`${n}:${t}`:t,{detail:r,bubbles:o,cancelable:i});return e.dispatchEvent(a),a}}h.blessings=[function(t){return i(t,"classes").reduce((t,e)=>{return Object.assign(t,{[`${r=e}Class`]:{get(){const{classes:t}=this;if(t.has(r))return t.get(r);{const e=t.getAttributeName(r);throw new Error(`Missing attribute "${e}"`)}}},[`${r}Classes`]:{get(){return this.classes.getAll(r)}},[`has${o(r)}Class`]:{get(){return this.classes.has(r)}}});var r},{})},function(t){return i(t,"targets").reduce((t,e)=>{return Object.assign(t,{[`${r=e}Target`]:{get(){const t=this.targets.find(r);if(t)return t;throw new Error(`Missing target element "${r}" for "${this.identifier}" controller`)}},[`${r}Targets`]:{get(){return this.targets.findAll(r)}},[`has${o(r)}Target`]:{get(){return this.targets.has(r)}}});var r},{})},function(t){const e=function(t,e){return a(t).reduce((t,e)=>(t.push(...function(t,e){const r=t.values;return r?Object.keys(r).map(t=>[t,r[t]]):[]}(e)),t),[])}(t),r={valueDescriptorMap:{get(){return e.reduce((t,e)=>{const r=s(e,this.identifier),n=this.data.getAttributeNameForKey(r.key);return Object.assign(t,{[n]:r})},{})}}};return e.reduce((t,e)=>Object.assign(t,function(t,e){const r=s(t,void 0),{key:n,name:i,reader:a,writer:c}=r;return{[i]:{get(){const t=this.data.get(n);return null!==t?a(t):r.defaultValue},set(t){void 0===t?this.data.delete(n):this.data.set(n,c(t))}},[`has${o(i)}`]:{get(){return this.data.has(n)||r.hasCustomDefaultValue}}}}(e)),r)}],h.targets=[],h.values={};var g=function(t){return void 0===t&&(t={}),Object.keys(t).map(function(e){return e+":"+t[e]}).join(";")},y=/*#__PURE__*/function(n){var o,i;function a(){for(var t,e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return(t=n.call.apply(n,[this].concat(r))||this).clicked=!1,t.canvasElement=null,t}i=n,(o=a).prototype=Object.create(i.prototype),o.prototype.constructor=o,r(o,i);var s,c,u=a.prototype;return u.spray=function(t){var e=this;t.preventDefault(),this.log("Spraying"),this.getStyle(t).then(function(){e.log("Finished animation"),e.followValue&&(!1===e.clicked&&e.followLink(),e.clicked=!0)})},u.getStyle=function(t){switch(this.animationValue){case"basic":default:return this.basic(t);case"school-pride":return this.schoolPride(t);case"stars":return this.stars(t)}},u.basic=function(t){return this.log("Basic started"),this.instance({particleCount:this.particleCountValue,startVelocity:this.startVelocityValue,spread:this.spreadValue,ticks:this.ticksValue,origin:{x:t.clientX/window.innerWidth,y:t.clientY/window.innerHeight}})},u.stars=function(t){var r=this;this.log("Stars started");var n={spread:this.spreadValue,ticks:50,gravity:0,decay:.94,startVelocity:this.startVelocityValue,shapes:["star"],colors:["FFE400","FFBD00","E89400","FFCA6C","FDFFB8"],origin:{x:t.clientX/window.innerWidth,y:t.clientY/window.innerHeight}};return new Promise(function(t){setTimeout(function(){r.instance(e({},n,{particleCount:r.particleCountValue,shapes:["star"]}))},70),r.instance(e({},n,{particleCount:r.particleCountValue,shapes:["star"]})).then(function(){r.log("Stars ended"),t()})})},u.schoolPride=function(t){var e=this;return this.log("School pride started"),new Promise(function(t){var r=Date.now()+1e3*e.durationValue,n=[e.firstColorValue,e.secondColorValue],o=e;!function e(){o.instance({particleCount:2,angle:60,spread:55,origin:{x:0},colors:n}),o.instance({particleCount:2,angle:120,spread:55,origin:{x:1},colors:n}),Date.now()<r?requestAnimationFrame(e):(o.log("School pride ended"),t())}()})},u.followLink=function(){var t=this;this.log("Following link");var e=document.createElement("a");e.style.cssText=g({opacity:0,display:"hidden"}),e.href=this.context.element.href,e.target=this.context.element.target,document.body.appendChild(e),e.click(),this.log("Followed link"),setTimeout(function(){t.log("Reset state"),t.clicked=!1},1)},u.log=function(t){this.debugValue&&console.log("[Stimulus confetti] "+t)},s=a,(c=[{key:"canvas",get:function(){if(this.canvasElement)return this.canvasElement;var t=document.createElement("canvas");return t.style.cssText=g({position:"fixed",top:0,right:0,bottom:0,left:0,width:"100%",height:"100%","pointer-events":"none","z-index":"9999"}),document.body.appendChild(t),this.canvasElement=t,this.canvasElement}},{key:"instance",get:function(){return t.create(this.canvas,{resize:!0,useWorker:!0})}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(s.prototype,c),Object.defineProperty(s,"prototype",{writable:!1}),a}(h);y.targets=["element"],y.values={follow:{type:Boolean,default:!0},animation:{type:String,default:"basic"},duration:{type:Number,default:5},firstColor:{type:String,default:"#0886DE"},secondColor:{type:String,default:"#FF6154"},particleCount:{type:Number,default:100},startVelocity:{type:Number,default:20},spread:{type:Number,default:360},ticks:{type:Number,default:90},debug:{type:Boolean,default:!1}};export{y as Confetti};
//# sourceMappingURL=stimulus_confetti.module.js.map
