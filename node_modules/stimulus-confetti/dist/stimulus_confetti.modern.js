import t from"canvas-confetti";function e(){return e=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},e.apply(this,arguments)}function r(t){return t.replace(/(?:[_-])([a-z0-9])/g,(t,e)=>e.toUpperCase())}function n(t){return t.charAt(0).toUpperCase()+t.slice(1)}function s(t,e){const r=i(t);return Array.from(r.reduce((t,r)=>(function(t,e){const r=t[e];return Array.isArray(r)?r:[]}(r,e).forEach(e=>t.add(e)),t),new Set))}function i(t){const e=[];for(;t;)e.push(t),t=Object.getPrototypeOf(t);return e.reverse()}function o([t,e],n){return function(t){const e=`${s=t.token,s.replace(/([A-Z])/g,(t,e)=>`-${e.toLowerCase()}`)}-value`,n=function(t){const e=function(t){const e=a(t.typeObject.type);if(!e)return;const r=c(t.typeObject.default);if(e!==r)throw new Error(`The specified default value for the Stimulus Value "${t.controller?`${t.controller}.${t.token}`:t.token}" must match the defined type "${e}". The provided default value of "${t.typeObject.default}" is of type "${r}".`);return e}({controller:t.controller,token:t.token,typeObject:t.typeDefinition}),r=c(t.typeDefinition),n=a(t.typeDefinition),s=e||r||n;if(s)return s;throw new Error(`Unknown value type "${t.controller?`${t.controller}.${t.typeDefinition}`:t.token}" for "${t.token}" value`)}(t);var s;return{type:n,key:e,name:r(e),get defaultValue(){return function(t){const e=a(t);if(e)return u[e];const r=t.default;return void 0!==r?r:t}(t.typeDefinition)},get hasCustomDefaultValue(){return void 0!==c(t.typeDefinition)},reader:l[n],writer:h[n]||h.default}}({controller:n,token:t,typeDefinition:e})}function a(t){switch(t){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function c(t){switch(typeof t){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}return Array.isArray(t)?"array":"[object Object]"===Object.prototype.toString.call(t)?"object":void 0}(()=>{try{!function(){const t=function(t){function e(){return Reflect.construct(t,arguments,new.target)}return e.prototype=Object.create(t.prototype,{constructor:{value:e}}),Reflect.setPrototypeOf(e,t),e}(function(){this.a.call(this)});t.prototype.a=function(){},new t}()}catch(t){return t=>class extends t{}}})();const u={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},l={array(t){const e=JSON.parse(t);if(!Array.isArray(e))throw new TypeError(`expected value of type "array" but instead got value "${t}" of type "${c(e)}"`);return e},boolean:t=>!("0"==t||"false"==String(t).toLowerCase()),number:t=>Number(t),object(t){const e=JSON.parse(t);if(null===e||"object"!=typeof e||Array.isArray(e))throw new TypeError(`expected value of type "object" but instead got value "${t}" of type "${c(e)}"`);return e},string:t=>t},h={default:function(t){return`${t}`},array:d,object:d};function d(t){return JSON.stringify(t)}class p{constructor(t){this.context=t}static get shouldLoad(){return!0}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(t,{target:e=this.element,detail:r={},prefix:n=this.identifier,bubbles:s=!0,cancelable:i=!0}={}){const o=new CustomEvent(n?`${n}:${t}`:t,{detail:r,bubbles:s,cancelable:i});return e.dispatchEvent(o),o}}p.blessings=[function(t){return s(t,"classes").reduce((t,e)=>{return Object.assign(t,{[`${r=e}Class`]:{get(){const{classes:t}=this;if(t.has(r))return t.get(r);{const e=t.getAttributeName(r);throw new Error(`Missing attribute "${e}"`)}}},[`${r}Classes`]:{get(){return this.classes.getAll(r)}},[`has${n(r)}Class`]:{get(){return this.classes.has(r)}}});var r},{})},function(t){return s(t,"targets").reduce((t,e)=>{return Object.assign(t,{[`${r=e}Target`]:{get(){const t=this.targets.find(r);if(t)return t;throw new Error(`Missing target element "${r}" for "${this.identifier}" controller`)}},[`${r}Targets`]:{get(){return this.targets.findAll(r)}},[`has${n(r)}Target`]:{get(){return this.targets.has(r)}}});var r},{})},function(t){const e=function(t,e){return i(t).reduce((t,e)=>(t.push(...function(t,e){const r=t.values;return r?Object.keys(r).map(t=>[t,r[t]]):[]}(e)),t),[])}(t),r={valueDescriptorMap:{get(){return e.reduce((t,e)=>{const r=o(e,this.identifier),n=this.data.getAttributeNameForKey(r.key);return Object.assign(t,{[n]:r})},{})}}};return e.reduce((t,e)=>Object.assign(t,function(t,e){const r=o(t,void 0),{key:s,name:i,reader:a,writer:c}=r;return{[i]:{get(){const t=this.data.get(s);return null!==t?a(t):r.defaultValue},set(t){void 0===t?this.data.delete(s):this.data.set(s,c(t))}},[`has${n(i)}`]:{get(){return this.data.has(s)||r.hasCustomDefaultValue}}}}(e)),r)}],p.targets=[],p.values={};const f=(t={})=>Object.keys(t).map(e=>`${e}:${t[e]}`).join(";");class g extends p{constructor(...t){super(...t),this.clicked=!1,this.canvasElement=null}get canvas(){if(this.canvasElement)return this.canvasElement;const t=document.createElement("canvas");return t.style.cssText=f({position:"fixed",top:0,right:0,bottom:0,left:0,width:"100%",height:"100%","pointer-events":"none","z-index":"9999"}),document.body.appendChild(t),this.canvasElement=t,this.canvasElement}get instance(){return t.create(this.canvas,{resize:!0,useWorker:!0})}spray(t){t.preventDefault(),this.log("Spraying"),this.getStyle(t).then(()=>{this.log("Finished animation"),this.followValue&&(!1===this.clicked&&this.followLink(),this.clicked=!0)})}getStyle(t){switch(this.animationValue){case"basic":default:return this.basic(t);case"school-pride":return this.schoolPride(t);case"stars":return this.stars(t)}}basic(t){return this.log("Basic started"),this.instance({particleCount:this.particleCountValue,startVelocity:this.startVelocityValue,spread:this.spreadValue,ticks:this.ticksValue,origin:{x:t.clientX/window.innerWidth,y:t.clientY/window.innerHeight}})}stars(t){this.log("Stars started");var r={spread:this.spreadValue,ticks:50,gravity:0,decay:.94,startVelocity:this.startVelocityValue,shapes:["star"],colors:["FFE400","FFBD00","E89400","FFCA6C","FDFFB8"],origin:{x:t.clientX/window.innerWidth,y:t.clientY/window.innerHeight}};return new Promise(t=>{setTimeout(()=>{this.instance(e({},r,{particleCount:this.particleCountValue,shapes:["star"]}))},70),this.instance(e({},r,{particleCount:this.particleCountValue,shapes:["star"]})).then(()=>{this.log("Stars ended"),t()})})}schoolPride(t){return this.log("School pride started"),new Promise(t=>{var e=Date.now()+1e3*this.durationValue,r=[this.firstColorValue,this.secondColorValue];const n=this;!function s(){n.instance({particleCount:2,angle:60,spread:55,origin:{x:0},colors:r}),n.instance({particleCount:2,angle:120,spread:55,origin:{x:1},colors:r}),Date.now()<e?requestAnimationFrame(s):(n.log("School pride ended"),t())}()})}followLink(){this.log("Following link");const t=document.createElement("a");t.style.cssText=f({opacity:0,display:"hidden"}),t.href=this.context.element.href,t.target=this.context.element.target,document.body.appendChild(t),t.click(),this.log("Followed link"),setTimeout(()=>{this.log("Reset state"),this.clicked=!1},1)}log(t){this.debugValue&&console.log(`[Stimulus confetti] ${t}`)}}g.targets=["element"],g.values={follow:{type:Boolean,default:!0},animation:{type:String,default:"basic"},duration:{type:Number,default:5},firstColor:{type:String,default:"#0886DE"},secondColor:{type:String,default:"#FF6154"},particleCount:{type:Number,default:100},startVelocity:{type:Number,default:20},spread:{type:Number,default:360},ticks:{type:Number,default:90},debug:{type:Boolean,default:!1}};export{g as Confetti};
//# sourceMappingURL=stimulus_confetti.modern.js.map
